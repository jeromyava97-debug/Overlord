# Overlord é¡¹ç›®ç›®å½•ç»“æ„è¯´æ˜

## é¡¹ç›®æ¦‚è§ˆ

```
Overlord/
â”œâ”€â”€ Overlord-Server/        # æœåŠ¡ç«¯ï¼ˆTypeScript + Bunï¼‰
â”œâ”€â”€ Overlord-Client/        # å®¢æˆ·ç«¯ï¼ˆGoï¼‰
â”œâ”€â”€ doc.md                  # é¡¹ç›®æ¶æ„æ–‡æ¡£
â”œâ”€â”€ WEBSOCKET_EVENTS.md     # WebSocket äº‹ä»¶ç»Ÿè®¡
â”œâ”€â”€ OPERATIONS.md           # æ“ä½œæŒ‡å—
â”œâ”€â”€ DOCKER.md               # Docker éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ PLUGINS.md              # æ’ä»¶å¼€å‘æŒ‡å—
â””â”€â”€ docker-compose.yml      # Docker ç¼–æ’é…ç½®
```

---

## ä¸€ã€æœåŠ¡ç«¯ç›®å½•ç»“æ„ï¼ˆOverlord-Serverï¼‰

### ğŸ“ æ ¹ç›®å½•

```
Overlord-Server/
â”œâ”€â”€ src/                    # æºä»£ç ç›®å½•
â”œâ”€â”€ public/                 # Web UI é™æ€èµ„æº
â”œâ”€â”€ plugins/                # æ’ä»¶å­˜å‚¨ç›®å½•
â”œâ”€â”€ data/                   # æ•°æ®å­˜å‚¨ï¼ˆæ•°æ®åº“ã€æ—¥å¿—ï¼‰
â”œâ”€â”€ certs/                  # TLS è¯ä¹¦
â”œâ”€â”€ package.json            # ä¾èµ–é…ç½®
â”œâ”€â”€ tsconfig.json           # TypeScript é…ç½®
â””â”€â”€ bun.lockb               # Bun ä¾èµ–é”æ–‡ä»¶
```

### ğŸ“‚ src/ - æ ¸å¿ƒæºä»£ç 

```
src/
â”œâ”€â”€ index.ts                # ä¸»æœåŠ¡å™¨å…¥å£ï¼ˆ4382è¡Œï¼‰
â”‚   â”œâ”€â”€ HTTP/WebSocket æœåŠ¡å™¨
â”‚   â”œâ”€â”€ å®¢æˆ·ç«¯è¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ è·¯ç”±å¤„ç†
â”‚   â”œâ”€â”€ è¿œç¨‹æ¡Œé¢ä¸­ç»§
â”‚   â””â”€â”€ å®¢æˆ·ç«¯æ„å»ºç³»ç»Ÿ
â”‚
â”œâ”€â”€ protocol.ts             # æ¶ˆæ¯åè®®å®šä¹‰
â”‚   â”œâ”€â”€ æ‰€æœ‰æ¶ˆæ¯ç±»å‹ï¼ˆHello, Command, Frame ç­‰ï¼‰
â”‚   â”œâ”€â”€ MessagePack ç¼–ç /è§£ç 
â”‚   â””â”€â”€ TypeScript ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ wsHandlers.ts           # WebSocket æ¶ˆæ¯å¤„ç†å™¨
â”‚   â”œâ”€â”€ handleHello - å¤„ç†å®¢æˆ·ç«¯ä¸Šçº¿
â”‚   â”œâ”€â”€ handlePing/Pong - å¿ƒè·³å¤„ç†
â”‚   â””â”€â”€ handleFrame - å±å¹•å¸§å¤„ç†
â”‚
â”œâ”€â”€ clientManager.ts        # å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ åœ¨çº¿å®¢æˆ·ç«¯åˆ—è¡¨
â”‚   â”œâ”€â”€ è¿æ¥çŠ¶æ€è·Ÿè¸ª
â”‚   â””â”€â”€ å®¢æˆ·ç«¯ä¿¡æ¯ç¼“å­˜
â”‚
â”œâ”€â”€ auth.ts                 # JWT è®¤è¯
â”‚   â”œâ”€â”€ ç”Ÿæˆ/éªŒè¯ JWT Token
â”‚   â”œâ”€â”€ å¯†ç å“ˆå¸Œï¼ˆbcryptï¼‰
â”‚   â””â”€â”€ ç™»å½•éªŒè¯
â”‚
â”œâ”€â”€ rbac.ts                 # åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
â”‚   â”œâ”€â”€ Admin - å®Œå…¨æƒé™
â”‚   â”œâ”€â”€ Operator - å®¢æˆ·ç«¯æ§åˆ¶
â”‚   â””â”€â”€ Viewer - åªè¯»æƒé™
â”‚
â”œâ”€â”€ db.ts                   # SQLite æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ å®¢æˆ·ç«¯ä¿¡æ¯è¡¨
â”‚   â”œâ”€â”€ ç”¨æˆ·è¡¨
â”‚   â”œâ”€â”€ å®¡è®¡æ—¥å¿—è¡¨
â”‚   â””â”€â”€ æ„å»ºå†å²è¡¨
â”‚
â”œâ”€â”€ logger.ts               # æ—¥å¿—ç³»ç»Ÿ
â”‚   â””â”€â”€ ç»“æ„åŒ–æ—¥å¿—è¾“å‡º
â”‚
â”œâ”€â”€ metrics.ts              # æ€§èƒ½æŒ‡æ ‡æ”¶é›†
â”‚   â”œâ”€â”€ è¿æ¥æ•°ç»Ÿè®¡
â”‚   â”œâ”€â”€ å¸¦å®½ç»Ÿè®¡
â”‚   â””â”€â”€ å»¶è¿Ÿç»Ÿè®¡
â”‚
â”œâ”€â”€ thumbnails.ts           # ç¼©ç•¥å›¾ç”Ÿæˆ
â”‚   â”œâ”€â”€ å±å¹•å¸§ç¼“å­˜
â”‚   â””â”€â”€ ç¼©ç•¥å›¾ç”Ÿæˆï¼ˆSharpï¼‰
â”‚
â”œâ”€â”€ auditLog.ts             # æ“ä½œå®¡è®¡
â”‚   â””â”€â”€ è®°å½•æ‰€æœ‰ç”¨æˆ·æ“ä½œ
â”‚
â”œâ”€â”€ rateLimit.ts            # é€Ÿç‡é™åˆ¶
â”‚   â””â”€â”€ é˜²æ­¢æš´åŠ›ç ´è§£
â”‚
â”œâ”€â”€ users.ts                # ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ åˆ›å»º/åˆ é™¤ç”¨æˆ·
â”‚   â”œâ”€â”€ ä¿®æ”¹å¯†ç 
â”‚   â””â”€â”€ è§’è‰²åˆ†é…
â”‚
â”œâ”€â”€ config.ts               # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ ç¯å¢ƒå˜é‡åŠ è½½
â”‚
â”œâ”€â”€ certGenerator.ts        # TLS è¯ä¹¦ç”Ÿæˆ
â”‚   â””â”€â”€ è‡ªç­¾åè¯ä¹¦åˆ›å»º
â”‚
â”œâ”€â”€ types.ts                # TypeScript ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ å…¨å±€ç±»å‹å£°æ˜
â”‚
â”œâ”€â”€ sessions/               # ä¼šè¯ç®¡ç†
â”‚   â”œâ”€â”€ sessionManager.ts   # ä¼šè¯è·Ÿè¸ªï¼ˆæ§åˆ¶å°ã€è¿œç¨‹æ¡Œé¢ï¼‰
â”‚   â””â”€â”€ types.ts            # ä¼šè¯ç±»å‹å®šä¹‰
â”‚
â””â”€â”€ build/                  # å®¢æˆ·ç«¯æ„å»ºç³»ç»Ÿ
    â”œâ”€â”€ buildManager.ts     # æ„å»ºç®¡ç†å™¨
    â”‚   â”œâ”€â”€ è°ƒç”¨ Go ç¼–è¯‘å™¨
    â”‚   â”œâ”€â”€ å¤šå¹³å°äº¤å‰ç¼–è¯‘
    â”‚   â”œâ”€â”€ ä»£ç æ··æ·†ï¼ˆgarbleï¼‰
    â”‚   â””â”€â”€ æ„å»ºå†å²ç®¡ç†
    â””â”€â”€ types.ts            # æ„å»ºç±»å‹å®šä¹‰
```

### ğŸ“‚ public/ - Web UI

```
public/
â”œâ”€â”€ index.html              # å®¢æˆ·ç«¯åˆ—è¡¨é¡µé¢
â”œâ”€â”€ login.html              # ç™»å½•é¡µé¢
â”œâ”€â”€ remotedesktop.html      # è¿œç¨‹æ¡Œé¢æŸ¥çœ‹å™¨
â”œâ”€â”€ console.html            # ç»ˆç«¯æ§åˆ¶å°
â”œâ”€â”€ filebrowser.html        # æ–‡ä»¶æµè§ˆå™¨
â”œâ”€â”€ processes.html          # è¿›ç¨‹ç®¡ç†å™¨
â”œâ”€â”€ plugins.html            # æ’ä»¶ç®¡ç†
â”œâ”€â”€ build.html              # å®¢æˆ·ç«¯æ„å»ºé¡µé¢
â”œâ”€â”€ users.html              # ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ metrics.html            # æ€§èƒ½æŒ‡æ ‡
â”œâ”€â”€ notifications.html      # é€šçŸ¥å†å²
â”‚
â””â”€â”€ assets/                 # é™æ€èµ„æº
    â”œâ”€â”€ js/                 # JavaScript æ–‡ä»¶
    â”‚   â”œâ”€â”€ remotedesktop.js    # è¿œç¨‹æ¡Œé¢é€»è¾‘
    â”‚   â”œâ”€â”€ console.js          # ç»ˆç«¯é€»è¾‘
    â”‚   â”œâ”€â”€ filebrowser.js      # æ–‡ä»¶ç®¡ç†é€»è¾‘
    â”‚   â””â”€â”€ ...
    â”‚
    â”œâ”€â”€ css/                # æ ·å¼æ–‡ä»¶
    â”‚   â””â”€â”€ style.css
    â”‚
    â””â”€â”€ icons/              # å›¾æ ‡èµ„æº
```

---

## äºŒã€å®¢æˆ·ç«¯ç›®å½•ç»“æ„ï¼ˆOverlord-Clientï¼‰

### ğŸ“ æ ¹ç›®å½•

```
Overlord-Client/
â”œâ”€â”€ cmd/agent/              # ä¸»ç¨‹åºç›®å½•
â”œâ”€â”€ go.mod                  # Go æ¨¡å—å®šä¹‰
â”œâ”€â”€ go.sum                  # ä¾èµ–æ ¡éªŒå’Œ
â””â”€â”€ Makefile                # æ„å»ºè„šæœ¬
```

### ğŸ“‚ cmd/agent/ - å®¢æˆ·ç«¯æ ¸å¿ƒ

```
cmd/agent/
â”œâ”€â”€ main.go                 # ç¨‹åºå…¥å£
â”‚   â”œâ”€â”€ åŠ è½½é…ç½®
â”‚   â”œâ”€â”€ è®¾ç½®æŒä¹…åŒ–
â”‚   â”œâ”€â”€ è·å–äº’æ–¥é”
â”‚   â””â”€â”€ å¯åŠ¨å®¢æˆ·ç«¯ä¼šè¯
â”‚
â”œâ”€â”€ session.go              # è¿æ¥ç®¡ç†
â”‚   â”œâ”€â”€ WebSocket è¿æ¥
â”‚   â”œâ”€â”€ è‡ªåŠ¨é‡è¿ï¼ˆæŒ‡æ•°é€€é¿ï¼‰
â”‚   â”œâ”€â”€ å¤šæœåŠ¡å™¨æ•…éšœè½¬ç§»
â”‚   â””â”€â”€ TLS é…ç½®
â”‚
â”œâ”€â”€ capture.go              # å±å¹•æ•è·ä¸»å¾ªç¯
â”‚   â””â”€â”€ åˆå§‹å¸§å‘é€
â”‚
â”œâ”€â”€ config/                 # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ config.go           # é…ç½®åŠ è½½ï¼ˆç¯å¢ƒå˜é‡/æ–‡ä»¶ï¼‰
â”‚       â”œâ”€â”€ æœåŠ¡å™¨åœ°å€
â”‚       â”œâ”€â”€ å®¢æˆ·ç«¯ ID
â”‚       â”œâ”€â”€ TLS è®¾ç½®
â”‚       â””â”€â”€ æŒä¹…åŒ–å¼€å…³
â”‚
â”œâ”€â”€ wire/                   # åè®®å±‚
â”‚   â”œâ”€â”€ protocol.go         # æ¶ˆæ¯ç»“æ„å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ Hello, Ping, Pong
â”‚   â”‚   â”œâ”€â”€ Command, Frame
â”‚   â”‚   â””â”€â”€ å„ç§ Result æ¶ˆæ¯
â”‚   â”‚
â”‚   â”œâ”€â”€ codec.go            # MessagePack ç¼–è§£ç 
â”‚   â””â”€â”€ writer.go           # æ¶ˆæ¯å‘é€å™¨
â”‚
â”œâ”€â”€ handlers/               # å‘½ä»¤å¤„ç†å™¨
â”‚   â”œâ”€â”€ dispatcher.go       # æ¶ˆæ¯è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ æ ¹æ®æ¶ˆæ¯ç±»å‹åˆ†å‘
â”‚   â”‚   â””â”€â”€ å‘½ä»¤å–æ¶ˆæœºåˆ¶
â”‚   â”‚
â”‚   â”œâ”€â”€ command.go          # å‘½ä»¤æ‰§è¡Œæ€»å…¥å£
â”‚   â”‚   â””â”€â”€ 50+ å‘½ä»¤ç±»å‹çš„ switch-case
â”‚   â”‚
â”‚   â”œâ”€â”€ desktop.go          # è¿œç¨‹æ¡Œé¢æ§åˆ¶
â”‚   â”‚   â”œâ”€â”€ DesktopStart - å¼€å§‹å±å¹•æµ
â”‚   â”‚   â”œâ”€â”€ DesktopStop - åœæ­¢æµ
â”‚   â”‚   â”œâ”€â”€ DesktopSelect - é€‰æ‹©æ˜¾ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ é¼ æ ‡/é”®ç›˜æ§åˆ¶å¼€å…³
â”‚   â”‚
â”‚   â”œâ”€â”€ files.go            # æ–‡ä»¶æ“ä½œï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ æ–‡ä»¶åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ ä¸Šä¼ /ä¸‹è½½
â”‚   â”‚   â”œâ”€â”€ åˆ é™¤/åˆ›å»º
â”‚   â”‚   â”œâ”€â”€ æœç´¢
â”‚   â”‚   â””â”€â”€ æƒé™ä¿®æ”¹
â”‚   â”‚
â”‚   â”œâ”€â”€ files_windows.go    # Windows ç‰¹å®šæ–‡ä»¶æ“ä½œ
â”‚   â”œâ”€â”€ files_unix.go       # Unix ç‰¹å®šæ–‡ä»¶æ“ä½œ
â”‚   â”‚
â”‚   â”œâ”€â”€ processes.go        # è¿›ç¨‹ç®¡ç†ï¼ˆé€šç”¨ï¼‰
â”‚   â”‚   â”œâ”€â”€ åˆ—å‡ºè¿›ç¨‹
â”‚   â”‚   â””â”€â”€ ç»“æŸè¿›ç¨‹
â”‚   â”‚
â”‚   â”œâ”€â”€ processes_windows.go # Windows è¿›ç¨‹ä¿¡æ¯
â”‚   â”œâ”€â”€ processes_unix.go    # Unix è¿›ç¨‹ä¿¡æ¯
â”‚   â”‚
â”‚   â”œâ”€â”€ screenshot.go       # æˆªå›¾å‘½ä»¤
â”‚   â”‚   â””â”€â”€ å•æ¬¡æˆªå›¾ï¼ˆéæµå¼ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ script.go           # è„šæœ¬æ‰§è¡Œ
â”‚   â”‚   â”œâ”€â”€ PowerShell
â”‚   â”‚   â”œâ”€â”€ Bash/sh
â”‚   â”‚   â”œâ”€â”€ CMD
â”‚   â”‚   â””â”€â”€ Python
â”‚   â”‚
â”‚   â”œâ”€â”€ silent_exec_windows.go # Windows é™é»˜æ‰§è¡Œ
â”‚   â”œâ”€â”€ silent_exec_unix.go    # Unix é™é»˜æ‰§è¡Œ
â”‚   â”‚
â”‚   â”œâ”€â”€ input_windows.go    # Windows é¼ æ ‡/é”®ç›˜è¾“å…¥
â”‚   â”œâ”€â”€ input_stub.go       # å…¶ä»–å¹³å°å ä½
â”‚   â”‚
â”‚   â””â”€â”€ plugin_event.go     # æ’ä»¶äº‹ä»¶å¤„ç†
â”‚
â”œâ”€â”€ capture/                # å±å¹•æ•è·æ¨¡å—
â”‚   â”œâ”€â”€ capture.go          # æ•è·ä¸»é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ CaptureAndSend - æ•è·å¹¶å‘é€
â”‚   â”‚   â”œâ”€â”€ buildFrame - æ„å»ºå¸§æ•°æ®
â”‚   â”‚   â”œâ”€â”€ encodeBlocks - å¢é‡ç¼–ç 
â”‚   â”‚   â””â”€â”€ æ€§èƒ½ç»Ÿè®¡
â”‚   â”‚
â”‚   â”œâ”€â”€ capture_vars_windows.go  # Windows å˜é‡
â”‚   â”œâ”€â”€ capture_vars_default.go  # é»˜è®¤å˜é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ monitors_windows.go # Windows æ˜¾ç¤ºå™¨æšä¸¾
â”‚   â”‚   â””â”€â”€ ä½¿ç”¨ EnumDisplayMonitors API
â”‚   â”‚
â”‚   â”œâ”€â”€ win_bitblt.go       # Windows å±å¹•æ•è·
â”‚   â”‚   â”œâ”€â”€ BitBlt API è°ƒç”¨
â”‚   â”‚   â”œâ”€â”€ DIB Section åˆ›å»º
â”‚   â”‚   â”œâ”€â”€ åƒç´ ç¼“å†²åŒºè®¿é—®
â”‚   â”‚   â””â”€â”€ RGB é€šé“äº¤æ¢
â”‚   â”‚
â”‚   â”œâ”€â”€ cursor_default.go   # å…‰æ ‡æ•è·ï¼ˆå ä½ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ jpeg_std.go         # JPEG ç¼–ç 
â”‚       â””â”€â”€ ä½¿ç”¨æ ‡å‡†åº“ image/jpeg
â”‚
â”œâ”€â”€ runtime/                # è¿è¡Œæ—¶ç¯å¢ƒ
â”‚   â”œâ”€â”€ env.go              # ç¯å¢ƒå˜é‡
â”‚   â”‚   â”œâ”€â”€ è¿æ¥å¯¹è±¡
â”‚   â”‚   â”œâ”€â”€ é…ç½®
â”‚   â”‚   â”œâ”€â”€ é€‰ä¸­çš„æ˜¾ç¤ºå™¨
â”‚   â”‚   â””â”€â”€ æ§åˆ¶å¼€å…³
â”‚   â”‚
â”‚   â””â”€â”€ console.go          # æ§åˆ¶å°ä¼šè¯ç®¡ç†
â”‚       â”œâ”€â”€ PTY åˆ›å»ºï¼ˆUnixï¼‰
â”‚       â”œâ”€â”€ ä¼šè¯è·Ÿè¸ª
â”‚       â””â”€â”€ è¾“å…¥/è¾“å‡ºå¤„ç†
â”‚
â”œâ”€â”€ plugins/                # æ’ä»¶ç³»ç»Ÿ
â”‚   â”œâ”€â”€ manager.go          # æ’ä»¶ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ WASM åŠ è½½ï¼ˆwazeroï¼‰
â”‚   â”‚   â”œâ”€â”€ æ’ä»¶ç”Ÿå‘½å‘¨æœŸ
â”‚   â”‚   â””â”€â”€ äº‹ä»¶é€šä¿¡
â”‚   â”‚
â”‚   â””â”€â”€ types.go            # æ’ä»¶ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ persistence/            # æŒä¹…åŒ–æœºåˆ¶
â”‚   â”œâ”€â”€ persistence.go      # é€šç”¨æ¥å£
â”‚   â”‚
â”‚   â”œâ”€â”€ persistence_windows.go # Windows å®ç°
â”‚   â”‚   â””â”€â”€ æ³¨å†Œè¡¨ Run é”®
â”‚   â”‚
â”‚   â”œâ”€â”€ persistence_linux.go   # Linux å®ç°
â”‚   â”‚   â”œâ”€â”€ Systemd ç”¨æˆ·æœåŠ¡
â”‚   â”‚   â””â”€â”€ Autostart æ¡Œé¢æ¡ç›®
â”‚   â”‚
â”‚   â””â”€â”€ persistence_darwin.go  # macOS å®ç°
â”‚       â””â”€â”€ LaunchAgent plist
â”‚
â””â”€â”€ activewindow/           # æ´»åŠ¨çª—å£ç›‘æ§
    â”œâ”€â”€ activewindow_windows.go # Windows å®ç°
    â”‚   â”œâ”€â”€ GetForegroundWindow API
    â”‚   â”œâ”€â”€ å…³é”®è¯åŒ¹é…
    â”‚   â”œâ”€â”€ æˆªå›¾è§¦å‘
    â”‚   â””â”€â”€ é€Ÿç‡é™åˆ¶
    â”‚
    â””â”€â”€ activewindow_stub.go    # å…¶ä»–å¹³å°å ä½
```

---

## ä¸‰ã€é…ç½®æ–‡ä»¶è¯´æ˜

### docker-compose.yml
```yaml
# Docker ç¼–æ’é…ç½®
- æœåŠ¡ç«¯å®¹å™¨å®šä¹‰
- ç«¯å£æ˜ å°„ï¼ˆ5173ï¼‰
- å·æŒ‚è½½ï¼ˆæ•°æ®æŒä¹…åŒ–ï¼‰
- ç¯å¢ƒå˜é‡é…ç½®
```

### Overlord-Server/package.json
```json
{
  "dependencies": {
    "@msgpack/msgpack": "MessagePack ç¼–è§£ç ",
    "bcrypt": "å¯†ç å“ˆå¸Œ",
    "better-sqlite3": "SQLite æ•°æ®åº“",
    "geoip-lite": "IP åœ°ç†ä½ç½®",
    "jsonwebtoken": "JWT è®¤è¯",
    "sharp": "å›¾ç‰‡å¤„ç†ï¼ˆç¼©ç•¥å›¾ï¼‰"
  }
}
```

### Overlord-Client/go.mod
```go
module overlord-client

require (
    github.com/vmihailenco/msgpack/v5  // MessagePack
    github.com/gorilla/websocket        // WebSocket å®¢æˆ·ç«¯
    github.com/shirou/gopsutil/v3       // ç³»ç»Ÿä¿¡æ¯
    github.com/tetratelabs/wazero       // WASM è¿è¡Œæ—¶
)
```

---

## å››ã€æ•°æ®å­˜å‚¨ç›®å½•

### Overlord-Server/data/
```
data/
â”œâ”€â”€ overlord.db             # SQLite æ•°æ®åº“
â”‚   â”œâ”€â”€ clients è¡¨ - å®¢æˆ·ç«¯ä¿¡æ¯
â”‚   â”œâ”€â”€ users è¡¨ - ç”¨æˆ·è´¦å·
â”‚   â”œâ”€â”€ audit_logs è¡¨ - æ“ä½œæ—¥å¿—
â”‚   â”œâ”€â”€ builds è¡¨ - æ„å»ºå†å²
â”‚   â””â”€â”€ notification_screenshots è¡¨ - é€šçŸ¥æˆªå›¾
â”‚
â”œâ”€â”€ thumbnails/             # å®¢æˆ·ç«¯ç¼©ç•¥å›¾ç¼“å­˜
â”‚   â””â”€â”€ {clientId}.jpg
â”‚
â””â”€â”€ logs/                   # æ—¥å¿—æ–‡ä»¶
    â””â”€â”€ server.log
```

### Overlord-Server/plugins/
```
plugins/
â””â”€â”€ {pluginId}/             # æ’ä»¶ç›®å½•
    â”œâ”€â”€ plugin.wasm         # WASM äºŒè¿›åˆ¶
    â”œâ”€â”€ manifest.json       # æ’ä»¶æ¸…å•
    â”œâ”€â”€ index.html          # UI ç•Œé¢
    â”œâ”€â”€ style.css           # æ ·å¼
    â””â”€â”€ script.js           # å‰ç«¯è„šæœ¬
```

---

## äº”ã€å…³é”®æ–‡ä»¶åŠŸèƒ½é€ŸæŸ¥

### ğŸ”¥ æ ¸å¿ƒæ–‡ä»¶ï¼ˆå¿…è¯»ï¼‰

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ |
|------|------|------|
| `Overlord-Server/src/index.ts` | 4382 | æœåŠ¡ç«¯ä¸»å…¥å£ï¼ŒåŒ…å«æ‰€æœ‰æ ¸å¿ƒé€»è¾‘ |
| `Overlord-Client/cmd/agent/main.go` | ~200 | å®¢æˆ·ç«¯ä¸»å…¥å£ |
| `Overlord-Client/cmd/agent/session.go` | ~300 | è¿æ¥ç®¡ç†å’Œé‡è¿é€»è¾‘ |
| `Overlord-Client/cmd/agent/handlers/command.go` | ~600 | å‘½ä»¤åˆ†å‘å™¨ï¼ˆ50+ å‘½ä»¤ï¼‰ |
| `Overlord-Client/cmd/agent/capture/capture.go` | ~690 | å±å¹•æ•è·å’Œç¼–ç  |
| `Overlord-Client/cmd/agent/capture/win_bitblt.go` | ~443 | Windows å±å¹•æ•è·å®ç° |

### ğŸ“‹ åè®®å®šä¹‰

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `Overlord-Server/src/protocol.ts` | æœåŠ¡ç«¯æ¶ˆæ¯ç±»å‹å®šä¹‰ |
| `Overlord-Client/cmd/agent/wire/protocol.go` | å®¢æˆ·ç«¯æ¶ˆæ¯ç±»å‹å®šä¹‰ |

### ğŸ” å®‰å…¨ç›¸å…³

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `Overlord-Server/src/auth.ts` | JWT è®¤è¯ |
| `Overlord-Server/src/rbac.ts` | æƒé™æ§åˆ¶ |
| `Overlord-Server/src/auditLog.ts` | æ“ä½œå®¡è®¡ |
| `Overlord-Server/src/rateLimit.ts` | é€Ÿç‡é™åˆ¶ |

### ğŸ¨ å‰ç«¯é¡µé¢

| æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|
| `public/index.html` | å®¢æˆ·ç«¯åˆ—è¡¨ï¼ˆä¸»é¡µï¼‰ |
| `public/remotedesktop.html` | è¿œç¨‹æ¡Œé¢æŸ¥çœ‹å™¨ |
| `public/console.html` | ç»ˆç«¯æ§åˆ¶å° |
| `public/filebrowser.html` | æ–‡ä»¶ç®¡ç†å™¨ |
| `public/build.html` | å®¢æˆ·ç«¯æ„å»ºå™¨ |

---

## å…­ã€æ„å»ºäº§ç‰©

### æœåŠ¡ç«¯æ„å»º
```
Overlord-Server/
â””â”€â”€ dist/                   # Bun æ„å»ºè¾“å‡ºï¼ˆå¦‚æœæœ‰ï¼‰
```

### å®¢æˆ·ç«¯æ„å»º
```
Overlord-Client/
â””â”€â”€ bin/                    # ç¼–è¯‘åçš„äºŒè¿›åˆ¶æ–‡ä»¶
    â”œâ”€â”€ overlord-windows-amd64.exe
    â”œâ”€â”€ overlord-linux-amd64
    â”œâ”€â”€ overlord-darwin-amd64
    â””â”€â”€ ...
```

---

## ä¸ƒã€å¼€å‘å·¥å…·é…ç½®

### TypeScript é…ç½®
- `tsconfig.json` - TypeScript ç¼–è¯‘é€‰é¡¹

### Go é…ç½®
- `go.mod` - Go æ¨¡å—ä¾èµ–
- `Makefile` - æ„å»ºè„šæœ¬

---

## å…«ã€æ–‡æ¡£æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `doc.md` | é¡¹ç›®æ¶æ„æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰ |
| `WEBSOCKET_EVENTS.md` | WebSocket äº‹ä»¶ç»Ÿè®¡ |
| `PROJECT_STRUCTURE.md` | æœ¬æ–‡ä»¶ - ç›®å½•ç»“æ„è¯´æ˜ |
| `OPERATIONS.md` | æ“ä½œæŒ‡å— |
| `DOCKER.md` | Docker éƒ¨ç½²æŒ‡å— |
| `PLUGINS.md` | æ’ä»¶å¼€å‘æŒ‡å— |
| `README.md` | é¡¹ç›®è¯´æ˜ |

---

## ä¹ã€å¿«é€Ÿå®šä½æŒ‡å—

### æƒ³è¦ä¿®æ”¹...

**è¿œç¨‹æ¡Œé¢åŠŸèƒ½ï¼š**
- æœåŠ¡ç«¯ï¼š`src/index.ts` (è¿œç¨‹æ¡Œé¢è·¯ç”±)
- å®¢æˆ·ç«¯ï¼š`cmd/agent/capture/` (å±å¹•æ•è·)
- å‰ç«¯ï¼š`public/remotedesktop.html`

**æ–‡ä»¶ç®¡ç†åŠŸèƒ½ï¼š**
- å®¢æˆ·ç«¯ï¼š`cmd/agent/handlers/files.go`
- å‰ç«¯ï¼š`public/filebrowser.html`

**è¿›ç¨‹ç®¡ç†åŠŸèƒ½ï¼š**
- å®¢æˆ·ç«¯ï¼š`cmd/agent/handlers/processes.go`
- å‰ç«¯ï¼š`public/processes.html`

**ç»ˆç«¯åŠŸèƒ½ï¼š**
- å®¢æˆ·ç«¯ï¼š`cmd/agent/runtime/console.go`
- å‰ç«¯ï¼š`public/console.html`

**è®¤è¯ç³»ç»Ÿï¼š**
- æœåŠ¡ç«¯ï¼š`src/auth.ts`, `src/rbac.ts`
- å‰ç«¯ï¼š`public/login.html`

**æŒä¹…åŒ–æœºåˆ¶ï¼š**
- å®¢æˆ·ç«¯ï¼š`cmd/agent/persistence/`

**æ’ä»¶ç³»ç»Ÿï¼š**
- æœåŠ¡ç«¯ï¼š`src/index.ts` (æ’ä»¶è·¯ç”±)
- å®¢æˆ·ç«¯ï¼š`cmd/agent/plugins/`
- å‰ç«¯ï¼š`public/plugins.html`

---

## åã€æ€»ç»“

### ä»£ç è§„æ¨¡ç»Ÿè®¡

| ç»„ä»¶ | è¯­è¨€ | ä¸»è¦æ–‡ä»¶æ•° | æ ¸å¿ƒä»£ç è¡Œæ•° |
|------|------|-----------|-------------|
| æœåŠ¡ç«¯ | TypeScript | ~20 | ~6000 |
| å®¢æˆ·ç«¯ | Go | ~30 | ~8000 |
| å‰ç«¯ | HTML/JS | ~15 | ~5000 |
| **æ€»è®¡** | - | **~65** | **~19000** |

### æŠ€æœ¯æ ˆ

**æœåŠ¡ç«¯ï¼š**
- Bun (JavaScript è¿è¡Œæ—¶)
- TypeScript
- SQLite
- MessagePack
- WebSocket

**å®¢æˆ·ç«¯ï¼š**
- Go 1.21+
- MessagePack
- WebSocket
- WASM (wazero)

**å‰ç«¯ï¼š**
- åŸç”Ÿ HTML/CSS/JavaScript
- æ— æ¡†æ¶ä¾èµ–

---

**è¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ¶æ„æ¸…æ™°çš„è¿œç¨‹ç®¡ç†ç³»ç»Ÿï¼** ğŸš€
